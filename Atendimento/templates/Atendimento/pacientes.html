{% extends 'global/template_geral.html' %}

<!-- titulo Web da pagina-->
{% block title_login %} Pacientes {% endblock title_login %}
{% load static %}

<!--CSS local-->
{% block css %} 
    <!--Tabela-->
    <link rel="stylesheet" href=" {% static 'global/tabela/css/style.css' %} "> 
    <!--Menu Local-->
    <link rel="stylesheet" href=" {% static 'global/css/menu/menu-local.css' %} ">     
    <link rel="stylesheet" href=" {% static 'global/css/search.css' %} "> 
{% endblock css %} 

<!--Titulo da Pagina-->
{% block body_title %}PACIENTES: Relação de Pacientes Cadastrados no Sistema::.  {% endblock body_title %}

{% block body_login %}    
<div class='menu-local-top' style='margin-top:-3.5%'>
    <ul>
        <li><a href="{% url 'Atendimento:lista-paciente' %}"><i class="fa-duotone fa-list-ul"></i> Listagem</a></li>
        <li > <a href=" {% url 'Atendimento:registro-paciente' %} "><i id="fa-hospital-user" class="fa-duotone fa-hospital-user fa-beat"></i><!--<i id="fa-address-card" class="fa-regular fa-address-card"></i>--> Cadastro</a></li>                
        <li > <a  href=" {% url 'Atendimento:lista_de_paciente_na_triagem' %} "><i class="fa-thin fa-diagram-successor"></i><!--<i id="fa-address-card" class="fa-regular fa-address-card"></i>--> Ir para <b>Fila de Espera</b></a></li>     
    </ul> 
</div>   
<div class='flex' style="margin:6% -5%;">    
    <div class="style-tabela">      
        <div class="border-bottom border-dark fs-3 d-flex">
            <i class="fa-duotone fa-list-ul"></i>
             Listagem de Pacientes  
        </div>
        <button onclick="exibe_info()" class="btn btn-bd-primary btn-primary btn-sm">Mais informações <i class="fa-duotone fa-hand-holding-medical"></i> </button>
        <div id="info" class="top-info border border-primary bg-primary-subtle rounded-1 p-2 m-3" style="margin:-0.2rem 0 0 2rem ; display: none;">
            Na tabela abaixo, está listado todos os pacientes cadastrados nesse sistema. 
            Caso não esteja visualizando o nome do paciente desejando, utilize o sistema de busca acima
             para encontar o nome dele, bastando somente digitar o nome é clicar em pesquisar. 
             Se desejar ter mais informações sobre o paciente, basta clicar sobre o nome desejado que 
             imediatamente que página contendo todas as informações desse paciente é aberto.
             <div style='text-align:right !important'><i class="fs-3 fa-duotone fa-hand-holding-medical"></i></div>
        </div>
        <div class="w-50" style="margin-left:25%; " >
            <form action="?" method="GET" class="form-inline bg-light rounded-5">
                {% csrf_token %}            
                <div class="search-wrapper rounded-5">
                  <input type="text" class="search-input rounded-5 m-0" placeholder=" CODIGO | Nº SUS | NOME DO PACIENTE" name="busca-paciente">
                  <button class="search-button" type="submit" style="width: 2.8rem;"><i class="fa-solid fa-search"></i></button>
                </div>
              </form>
        </div>
       <div class="">         
            <div class='btn btn-sm border mb-3'><span class='fs-3'>{{object_list.count}}</span> registros de paciente no sistema</div>
            <nav aria-label="Page navigation example">
                <ul class="pagination justify-content-end">
                {% if page_obj.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?page={{page_obj.previous_page_number}}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                    <span class="sr-only">Previous</span>
                    </a>
                </li>
                {% endif %}
                {% for page in paginator.page_range %}
                    {% if page_obj.number|add:"-10" <= page <= page_obj.number|add:"10" %}
                    <li class="page-item {% if page == page_obj.number %}active{% endif %}">
                        <a class="page-link" href="?page={{ page }}">{{ page }}</a>
                    </li>
                    {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}  
                <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                    <span class="sr-only">Next</span>
                    </a>
                </li>
                {% endif %}
                </ul>
            </nav>
        </div>
        
        <table id="tabela-listar" border="0" cellpadding="0" cellspacing="0" width="100%" style='margin-top:0.1rem'>                
                <thead>
                    <tr>
                    <td class="top center fs-7"><strong>Codigo</strong></td>
                    <td class="top center fs-7"><strong>Nome Social</strong></td>                    
                    <td class="top center fs-7"><strong>Telefone</strong></td>
                    <td class="top center fs-7"><strong>Idade</strong></td>
                    <td class="top center fs-7"><strong>Bairro</strong></td>
                    <td class="top center fs-7"><strong>Data de Nascimento</strong></td>
                    <td class="top center fs-7"><strong>RG</strong></td>
                    <td class="top center fs-7"><strong>SUS</strong></td>
                    <td class="top center fs-7"><strong>Alergias</strong></td>
                    <td class="top center fs-7"><strong>Comorbidades</strong></td>
                    <td class="top center fs-7" colspan="2" ><strong>Atualizar</strong></td>
                    </tr>
                </thead> 
                <tbody> 
                   
                    {% for campo in object_list %}  
                    <tr> 
                        <td align="center" href="">{{campo.codigo_pacient}}</td>
                        <td class="fs-6"><a class="link-color" href="{% url 'Atendimento:perfil-paciente' campo.pk %}"><span>{{campo.nome_social}}</span></a></td>                                                        
                        <td align="center" href="">{{campo.tel}}</td>
                        <td align="center" href="">{{campo.idade}}</td>                        
                        <td align="center">{{campo.bairro}}</td>
                        <td align="center">{{campo.data_nascimento}}</td>
                        <td align="center">{{campo.RG}}</td>
                        <td align="center">{{campo.cartao_sus}}</td>
                        
                        <td align="center" >
                            {% if campo.alergias == '0'  %}
                                <span class="text-primary">Nâo</span>
                            {% else %}
                                <span class='text-danger'>Sim <i class="fa-sharp fa-solid fa-circle-exclamation"></i></span>
                            {% endif %}
                        </td>
                        {{campo.comorbidades}}
                        {% if campo.comorbidades == '0' %}
                            <td align="center" class="text-primary">NÃO</td>                                
                            {% else %} 
                            <td align="center" class="text-danger">SIM</td>
                        {% endif %}
                        <td align="center"> <a href="{% url 'Atendimento:atualizar-paciente' campo.pk   %}" class="editar fa fa-check-circle" title="Editar"></a> </td>                
                    </tr>       
                    
                    {% empty%}
                        <tr>
                            <td colspan='11' class='text-center'>"Nenhum paciente foi cadastrado até o momento."</td>        
                        </tr>                       
                    {% endfor %}
                </tbody>                
        </table>                    
    </div><!--tabela-->   

</div>     

<script>
    function exibe_info(){
        var div_info = document.getElementById('info');
        var disp = div_info.style.display;
        div_info.style.display = disp === 'none' ? 'block' : 'none';
    }
</script>

{% endblock body_login %}
