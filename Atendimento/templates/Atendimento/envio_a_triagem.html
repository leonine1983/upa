{% extends 'global/template_geral.html' %}
{% load static %}
{% block title_login %}FILA DE ESPERA {% endblock title_login %}
{% block css %}
    <!--Css do Select2-->    
    <link rel="stylesheet" href=" {% static 'global/css/formularios.css' %}">    
    <link rel="stylesheet" href=" {% static 'global/css/tabela-div.css' %}">
    <style>
        .select2 {
            width:35rem !important;
            margin-right:-20rem;
            margin-left:20%;  
            margin-bottom:3rem;
          }
          .button-salvar{
            margin-bottom:2rem
          }
    </style>
{% endblock css %}    
{% block script %}
    <!--Script do Select2-->
<script>
    // In your Javascript (external .js resource or <script> tag)
$(document).ready(function() {
    $('#id_paciente_envio_triagem').select2();
});
</script>

{% endblock script %}
{% block body_title %}<i class="fa-duotone fa-person-seat"></i><i class="fa-duotone fa-person-seat"></i><i class="fa-duotone fa-person-seat"></i> Fila de espera para classificação ::. {% endblock body_title %}

{% block body_login %}
<!--Botão adicionar a lista de triagem-->
{% if lista_db %}
<a href="{% url 'Atendimento:envio_paciente_a_triagem' %}" class='button-salvar' style='margin-bottom:1rem!important' >Adicionar paciente a lista de triagem <i class="fa-solid fa-plus"></i></a>
{% endif %}
<!-- FIM Botão adicionar a lista de triagem-->

<table class=' table table-striped'>
    <tr>
        <th class='linha-titulo'>Nome do Paciente</th>
        <th class='linha-titulo'>Data de entrada na fila de triagem</th>
        <th class='linha-titulo'>Horário de entrada na fila de triagem</th>
        <th class='linha-titulo'>Excluir paciente da fila de triagem</th>
    </tr>
    
    {% if not get_id %}
    {% for db in lista_db %}            
        <tr>
            <td class>
                <a class="link-color" href="{% url 'Atendimento:perfil-paciente' db.paciente_envio_triagem_id %}"><span>{{db.paciente_envio_triagem}}</span></a>                                                      
            </td>
            <td>
                <a class="link-color" href="{% url 'Atendimento:perfil-paciente' db.paciente_envio_triagem_id %}"><span>{{db.data_envio_triagem}} </span></a>                                                      
            </td>
            <td>
                <a class="link-color" href="{% url 'Atendimento:perfil-paciente' db.paciente_envio_triagem_id %}"><span>{{db.horario_triagem}} </span></a>                                                      
            </td>
            <td>                
                <a href="{% url 'Atendimento:delete_de_paciente_na_triagem' db.id %}" class=" text-danger" title="Deletar"> <i class="fa-solid fa-user-xmark excluir"></i></a> 
            </td>            
        </tr>
        {% empty%} 
        {% endfor %}
        {{q3}}{{q3}}
    </table>
    <div>&nbsp;</div>
    <div class="bloco flex">
        <div class="calendario">
            {% if  url == 'Atendimento:envio_paciente_a_triagem'%}   
            <form>
                <label for="start_date" >::CALENDÁRIO::</label>
                <div>Utilize o calendário para acompanhar os lançamentos na
                    <b>Fila de Triagem</b> de datas anteriores à atual            
                </div>  
                <p>&nbsp;</p>          
                <p><input type="date" name='start_date'>
                <button class="btn" type="submit" style='margin-top:1rem; background-color:cadetblue'>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar" viewBox="0 0 16 16">
                    <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                  </svg> Exibir por data</button></p>
            </form>
            {% endif %}
        </div>   

        <div class="" style='width:75%'>  
            {% if not lista_db %}   
            <div>         
                <form action="" method='POST'>      
                        {% csrf_token %}        
                        {{form.paciente_envio_triagem}}  
                    {% if not url == 'Atendimento:envio_paciente_a_triagem'%} 
                     
                    <button class='button-salvar' type="submit">
                        Salvar Paciente na Fila de espera para classificação
                        <i class="fa-solid fa-plus"></i>
                    </button>
                    {% else %}
                    <a href="{% url 'Atendimento:envio_paciente_a_triagem' %}" class='button-salvar' style='margin-bottom:1rem!important; margin-top:-15rem!important;'  >Adicionar a(o) paciente a lista de triagem <i class="fa-solid fa-plus"></i></a>                   
                    {% endif %}                
                </form>        
                <a href=" {% url 'Atendimento:registro-paciente' %} "> Cadastrar Paciente</a>
                <p>Utilize o sistema de busca no campo <b>Busca paciente</b> 
                    para pequisar o cadastro do paciente no sistema e em seguida envia-lo à fila de triagem. Caso não encontre o nome do paciente, clique no link 
                    <b>Cadastrar Paciente</b> para ir para a página de cadastro de paciente para lançá-lo no sistema. Em seguida, 
                        retorne a essa página para adicioná-lo à fila de triagem. 
                </p>
            </div>
            {% endif %}
        </div>

    <!--TABELA COM RELAÇÃO DE PACIENTES NA TRIAGEM-->
    {% if lista_db %}
        <div class="top-info">
            Na tabela acima está listado todos os pacientes que estão aguardando para passar
            pela etapa de TRIAGEM. Se houver necessidade de excluir algum nome, basta clicar no botão com um X.
        </div>
    </div>  
    <div class="style-tabela">        
        <a  href="{% url 'Atendimento:lista_de_paciente_na_triagem' %}">Voltar <i class="fa-solid fa-person-walking-arrow-loop-left"></i></a>    
    {% endif %}
    <!--tabela-->  

    <div class="controle_tabela">
        {% if page_obj.has_previous %}
            <a class="" href="?page={{page_obj.previous_page_number}}"><i class="fa-solid fa-angles-left"></i> Voltar</a>    
                            
        {% endif %}
        {% if page_obj.has_next %}               
            <a href="?page={{ page_obj.next_page_number }}">Próxima página <i class="fa-solid fa-angles-right"></i></a>    
        {% endif %}    
    {% else %}
    <!--Aqui entra o codigo que enviar os pacientes recem cadastrados para a fila de triagem-->
    <div style="text-align: center;" >         
        <form action="" method='POST' >  
            {% csrf_token %}
            {% for n in get_id  %}
                <input name="paciente_envio_triagem" type="hidden" value="{{n.id}}">  
                <span class='fs-4'>Deseja enviar <b class="uppercase">{{n.nome_social}}</b> para a fila de espera para a classficação?</span>           
            
                <div class="flex w-75 m-auto p-2" >
                    <a href="{% url 'Atendimento:registro-paciente' %}" class="btn btn-sm btn-danger col m-1">Não (Manter somente o cadastro)</a>   
                    <button class='col btn btn-sm btn-primary m-1' type="submit">
                        SIM <i class="fa-duotone fa-person-seat"></i>
                    <i class="fa-solid fa-plus"></i>
                    </button>
                </div>   
            {% endfor %}                 
        </form>        
    </div>
{% endif %}
</div>
<p>&nbsp;</p>
<script src="{% static 'global/js/select2.min.js' %}"></script>
    <script>
        // In your Javascript (external .js resource or <script> tag)
    $(document).ready(function() {
        $('#id_paciente_envio_triagem').select2();
  
    });
    </script>

{% endblock body_login %}
